openapi: 3.0.0
# Revisions:
# 2019-05-11 initial version deeply based on https://app.swaggerhub.com/apis/cportele/opf-features-api/1.0.0
# 2019-05-15 Extending the example of the landing page
# 2019-05-15 Extending the example of the conformace page
# 2019-05-15 Extending the schema for CollectionInfo to include TileMatrixSetLink (with a link to the TileMatrixSet description and a link to the Tiles) 
# 2019-05-15 Extending the schema for CollectionInfo to include a link to maps
# 2019-05-17 /tiles and /collections/{collectionId}/tile are removed as they seem reduntant with checking the metadata in the /collections/{collectionId}. Returning tiles from deveral tileMatrixSetIds seems too much.
# 2019-05-17 removed the word "feature" from the summary if /collections
# 2019-05-17 /TileMatrixSet and derivates are considered "metadata" so are moved to the capabilities section.
# 2019-06-14 
servers:
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/joanma747/opf-map-tiles-api/1.0.0
info:
  title: |-
    OGC API Maps and Tiles (preliminary DRAFT)
  description: |-
    This is a draft of the OGC API maps and tiles produced in the Testbed-15 Open Portrayal Framework in collaboration with the WMS.SWG. The Map Tile API is a Web API for fetching and managing maps and tiles.
    
    The extensions are the following.
    * There are 
    * The feature collection metadata (path `/collections/{collectionId}`) has been extended by the set of applicable styles (member `styles`, same
    value as in `/styles` in the Style API) and a default style 
    (member `defaultStyle`, the style id).
    * The PATCH operation on the feature collection metadata 
    (path `/collections/{collectionId}`) has been added. Only `styles` and
    `defaultStyle` may be updated.
    * The queryables resource (path `/collections/{collectionId}/queryables`)
    has been added to support clients like visual style editors to construct 
    expressions for selection criteria in queries on features in the collection.

    For more background information see [the Vector Tiles Pilot Extension Engineering 
    Report](http://docs.opengeospatial.org/per/18-101.html#StylesAPI).

  version: "1.0.0"
  contact:
    name: Jaon Maso
    email: joan.maso@uab.cat
  license:
    name: OGC License
    url: 'https://raw.githubusercontent.com/opengeospatial/OGC-API-Map-Tiles/master/LICENSE'
tags:
  - name: Capabilities
    description: |-
      essential characteristics of this API
  - name: Features
    description: |-
      access to data (features)
  - name: Tiles
    description: |-
      access to data representations, partitioned into a hierarchy of tiles (renderizations or vector tiles).
  - name: Maps
    description: |-
      access to map renderizations of collections.
  - name: FeatureInfos
    description: |-
      access to information about a point in a map or a tile.
  - name: MultiTiles
    description: |-
      access to information about retriving multiple tiles in a single request.
paths:
  '/':
    get:
      tags:
        - Capabilities
      summary: landing page
      description: |-
        The landing page provides links to the API definition, the conformance statements and to the feature collections in this dataset.
      operationId: getLandingPage
      parameters:
        - $ref: '#/components/parameters/f-json-html'
      responses:
        '200':
          description: |-
            Links to the API capabilities and the TileMatrixSets shared by this API.
          content:
            application/json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/landing-page'
              example:
                - href: 'http://data.example.org/?f=json'
                  rel: self
                  type: application/json
                  title: this document
                - href: 'http://data.example.org/?f=html'
                  rel: alternate
                  type: text/html
                  title: this document in HTML
                - href: 'http://data.example.org/api?f=json'
                  rel: service
                  type: application/vnd.oai.openapi+json;version=3.0
                  title: the API definition in OpenAPI 3.0 JSON
                - href: 'http://data.example.org/api?f=html'
                  rel: service
                  type: text/html
                  title: the API definition in HTML
                - href: 'http://data.example.org/conformance?f=json'
                  rel: conformance
                  type: application/json
                  title: the list of conformance classes implemented by this API
                - href: 'http://data.example.org/collections?f=json'
                  rel: data
                  type: application/json
                  title: The feature collections in the dataset in JSON
                - href: 'http://data.example.org/collections?f=html'
                  rel: data
                  type: text/html
                  title: The feature collections in the dataset in HTML
                - href: 'http://data.example.org/tileMatrixSet?f=json'
                  rel: tileMatrixSets
                  type: application/json
                  title: the list of tileMatrixSets implemented by this API in JSON
                - href: 'http://data.example.org/tileMatrixSet?f=html'
                  rel: tileMatrixSets
                  type: text/html
                  title: the list of tileMatrixSets implemented by this API in HTML       
            text/html:
              schema:
                type: string
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/conformance':
    get:
      summary: information about specifications that this API conforms to
      description: |-
        A list of all requirements classes specified in a standard that the 
        server conforms to.
      operationId: getConformanceDeclaration
      parameters:
        - $ref: '#/components/parameters/f-json'
      tags:
        - Capabilities
      responses:
        '200':
          description: |-
            the URIs of all requirements classes supported by 
            this API        
          content:
            application/json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/req-classes'
              example:
                - 'http://www.opengis.net/spec/ogcapi-features-1/1.0/req/core'
                - 'http://www.opengis.net/spec/ogcapi-features-1/1.0/req/oas30'
                - 'http://www.opengis.net/spec/ogcapi-features-1/1.0/req/html'
                - 'http://www.opengis.net/spec/ogcapi-features-1/1.0/req/geojson'
                - 'http://www.opengis.net/spec/ogcapi-maps-1/1.0/req/core'
                - 'http://www.opengis.net/spec/ogcapi-maps-1/1.0/req/info'
                - 'http://www.opengis.net/spec/ogcapi-tiles-1/1.0/req/core'
                - 'http://www.opengis.net/spec/ogcapi-tiles-1/1.0/req/multitile'
                - 'http://www.opengis.net/spec/ogcapi-tiles-1/1.0/req/info'
        '400':
          description: |-
            invalid or unknown query parameters
        '406':
          description: |-
            The media types accepted by the client are not 
            supported for this resource
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/collections':
    get:
      tags:
        - Capabilities
      summary: the collections in the dataset
      operationId: getCollections
      parameters:
        - $ref: '#/components/parameters/f-json-html'
      responses:
        '200':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/Collections'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/collections/{collectionId}':
    get:
      tags:
        - Capabilities
      summary: describe a collection
      operationId: describeCollection
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collectionId'
        - $ref: '#/components/parameters/f-json-html'
      responses:
        '200':
          description: |-
            Metadata about the collection including style information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/collectionInfo'
            text/html:
              schema:
                type: string
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
    patch:
      tags:
        - Capabilities
      summary: |-
        update parts of the style metadata
      description: |-
        IMPORTANT: This operation is defined by Clemens P. in the Testbed 15. It is included here for INFORMATION ONLY But is OUT OF SCOPE for Maps and Tiles.
        
        Update selected elements of the metadata for 
        the collection with the id `collectionId`.
        
        The only members that may be updated at this 
        time are `styles` and `defaultStyle`.
        
        The PATCH semantics in this operation are defined by 
        RFC 7396 (JSON Merge Patch). From the specification:
        
        _"A JSON merge patch document describes changes to be 
        made to a target JSON document using a syntax that 
        closely mimics the document being modified. Recipients
        of a merge patch document determine the exact set of 
        changes being requested by comparing the content of 
        the provided patch against the current content of the 
        target document. If the provided merge patch contains 
        members that do not appear within the target, those 
        members are added. If the target does contain the 
        member, the value is replaced. Null values in the 
        merge patch are given special meaning to indicate 
        the removal of existing values in the target."_
        
        Some examples:
        
        To add or update the default style, just send
        
        ```
        {
          "defaultStyle": "night"
        }
        ```
        
        To remove the default style, send 

        ```
        {
          "defaultStyle": null
        }
        ```
        
        For arrays the complete array needs to be sent. I.e., to
        update the list of styles, send the complete new array value.

        To remove all styles, send
        
        ```
        {
          "styles": null
        }
        ```
        
        This operation is only available to registered 
        users.
      operationId: patchCollectionMetadata
      security:
        - BasicAuth: []
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collectionId'
      requestBody:
        description: |-
          The updated style information for the collection.
        content:
          application/merge-patch+json:
            schema:
              $ref: '#/components/schemas/collectionInfo-patch'
      responses:
        '204':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/Updated'
        '400':
          description: |-
            Malformed patch document.
        '401':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/UnauthorizedAccess'
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '415':
          description: |-
            Unsupported patch document.
          headers:
            Accept-Patch:
              description: |-
                supported patch document media types
              schema:
                type: string
        '422':
          description: |-
            Unprocessable request. The patch document appears 
            to be valid, but the server is incapable of processing 
            the request.
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/collections/{collectionId}/items':
    get:
      tags:
        - Features
      summary: retrieve features of the feature collection
      description: |-
        IMPORTANT: This operation is defined by in OGC API features. It is included here for INFORMATION ONLY But is OUT OF SCOPE for Maps and Tiles.
      operationId: getFeatures
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collectionId'
        - $ref: '#/components/parameters/f-json-html'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/limit'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/offset'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/bbox'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/datetime'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/resultType'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/properties'
        - name: f_code
          in: query
          description: Filter the collection by f_code
          required: false
          style: form
          explode: false
          schema:
            type: string
      responses:
        '200':
          description: |-
            Information about the feature collection plus the first features
            matching the selection parameters.
          content:
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureCollectionGeoJSON'
            text/html:
              schema:
                type: string
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/collections/{collectionId}/items/{featureId}':
    get:
      tags:
        - Features
      summary: fetch a feature
      description: |-
        IMPORTANT: This operation is defined by in OGC API features. It is included here for INFORMATION ONLY But is OUT OF SCOPE for Maps and Tiles.      
      operationId: getFeature
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collectionId'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/featureId'
        - $ref: '#/components/parameters/f-json-html'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/properties'
      responses:
        '200':
          description: |-
            A feature.
          content:
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureGeoJSON'
            text/html:
              schema:
                type: string
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/tileMatrixSet':
    get:
      tags:
        - Capabilities
      summary: fetch all available tile matrix sets (tiling schemes)
      operationId: getTileMatrixSets
      parameters:
        - $ref: '#/components/parameters/f-json'
      responses:
        '200':
          description: |-
            A list of tiling schemes.
          content:
            application/json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/tileMatrixSet'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/tileMatrixSet/{tileMatrixSetId}':
    get:
      tags:
        - Capabilities
      summary: fetch a tiling scheme by id
      operationId: getTileMatrixSetDescription
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrixSetId'
        - $ref: '#/components/parameters/f-json'
      responses:
        '200':
          description: A tiling scheme.
          content:
            application/json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/tileMatrixSet'
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/tiles/{tileMatrixSetId}/{tileMatrix}/{tileRow}/{tileCol}':
    get:
      tags:
        - Tiles
      summary: fetch a tile from one or more collections
      description: |-
        The tile in the requested tiling scheme, on the requested zoom level in
        the tiling scheme, with the requested grid coordinates (row, column) is
        returned. Each collection of the dataset is returned as a separate
        layer. The collections and the feature properties to include in the tile
        representation can be limited using query parameters.
      operationId: getTileCollections
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collections'
        - $ref: '#/components/parameters/styles'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrixSetId'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrix'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileRow'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileCol'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/datetime'        
        - $ref: '#/components/parameters/f-png-jpeg-vector'
      responses:
        '200':
          description: |-
            A multi-layer tile of the dataset.
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
            image/png:
              schema:
                type: string
                format: binary
            image/gif:
              schema:
                type: string
                format: binary
            image/mvt:
              schema:
                type: string
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureCollectionGeoJSON'          
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/collections/{collectionId}/tiles/{styleId}/{tileMatrixSetId}/{tileMatrix}/{tileRow}/{tileCol}':
    get:
      tags:
        - Tiles
      summary: fetch a tile from a collection
      description: |-
        Retrieves the tile in the requested tileMatrixSet, on the requested tileMatrix in the TileMatrixSet, with the requested tile indices (tileRow, tileCol). The tile has a single collection (formerly refered as layer) with all selected features in the bounding box of the tile. The feature properties to include in the tile representation can be limited using a query parameter.
      operationId: getTileOfCollectionId
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collectionId'
        - $ref: '#/components/parameters/styleId'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrixSetId'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrix'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileRow'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileCol'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/datetime'
        - $ref: '#/components/parameters/f-png-jpeg-vector'
      responses:
        '200':
          description: A tile of the collection.
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
            image/png:
              schema:
                type: string
                format: binary
            image/gif:
              schema:
                type: string
                format: binary
            image/mvt:
              schema:
                type: string
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureCollectionGeoJSON'
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/tiles/{tileMatrixSetId}/{tileMatrix}/{tileRow}/{tileCol}/info':
    get:
      tags:
        - Tiles
        - FeatureInfos
      summary: fetch information about a point in a tile from one or more collections
      description: |-
        Retrieves information about a point of a tile in the requested tileMatrixSet, on the requested tileMatrix in the TileMatrixSet, with the requested tile indices (tileRow, tileCol). The tile has a single collection (formerly refered as layer) with all selected features in the bounding box of the tile. The feature properties to include in the tile representation can be limited using a query parameter.
      operationId: getFeatureInfoTileOfCollections
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collections'
        - $ref: '#/components/parameters/styles'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrixSetId'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrix'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileRow'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileCol'
        - $ref: '#/components/parameters/coord_i'
        - $ref: '#/components/parameters/coord_j'
        - $ref: '#/components/parameters/infoTemplate'
        - $ref: '#/components/parameters/tileFormat'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/datetime'
        - $ref: '#/components/parameters/f-json-html'
      responses:
        '200':
          description: A getFeatureInfo of a tile of the collections.
          content:
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureCollectionGeoJSON'
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/collections/{collectionId}/tiles/[stylesId}/{tileMatrixSetId}/{tileMatrix}/{tileRow}/{tileCol}/info':
    get:
      tags:
        - Tiles
        - FeatureInfos
      summary: fetch information about a point on a tile from a collection
      description: |-
        Retrieves inforamtion on a point of a tile in the requested tileMatrixSet, on the requested tileMatrix in the TileMatrixSet, with the requested tile indices (tileRow, tileCol). The tile has a single collection (formerly refered as layer) with all selected features in the bounding box of the tile. The feature properties to include in the tile representation can be limited using a query parameter.
      operationId: getFeatureInfoTileOfCollectionId
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collectionId'
        - $ref: '#/components/parameters/styleId'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrixSetId'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrix'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileRow'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileCol'
        - $ref: '#/components/parameters/coord_i'
        - $ref: '#/components/parameters/coord_j'
        - $ref: '#/components/parameters/infoTemplate'
        - $ref: '#/components/parameters/tileFormat'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/datetime'
        - $ref: '#/components/parameters/f-json-html'
      responses:
        '200':
          description: A getFeatureInfo of a tile of the collection.
          content:
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureCollectionGeoJSON'
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/tiles/{tileMatrixSetId}':
    get:
      tags:
        - MultiTiles
      summary: fetch tiles from one or more collections.
      description: |-
        Tiles in the requested tiling scheme. 
        The collections and the feature properties to include in the tile
        representation can be limited using query parameters.
        The CRS of the bbox is the CRS indicated int he TileMatrixSet definition.
      operationId: getTilesCollections
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collections'
        - $ref: '#/components/parameters/styles'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrixSetId'
        - $ref: '#/components/parameters/scaleDenRange'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/bbox'
        - $ref: '#/components/parameters/tileFormat'
        - $ref: '#/components/parameters/embedded'
        - $ref: '#/components/parameters/f-json-zip'
      responses:
        '200':
          description: |-
            A tiling scheme used to partition the dataset into tiles.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/tiles-set'
            application/x-zip-compressed:
              schema:
                type: string
                format: binary
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/collections/{collectionId}/tiles/{styleId}{tileMatrixSetId}':
    get:
      tags:
        - MultiTiles
      summary: |-
        fetch tiles of a collection
      operationId: getTiles
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collectionId'
        - $ref: '#/components/parameters/styleId'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/tileMatrixSetId'
        - $ref: '#/components/parameters/scaleDenRange'        
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/bbox'
        - $ref: '#/components/parameters/tileFormat'
        - $ref: '#/components/parameters/embedded'        
        - $ref: '#/components/parameters/f-json-zip'
      responses:
        '200':
          description: |-
            A tiling scheme used to partition the collection into tiles.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/tiles-set'
            application/x-zip-compressed:
              schema:
                type: string
                format: binary
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'          
  '/map':
    get:
      tags:
        - Maps
      summary: fetch a map from one or more collections
      description: |-
        Retrieves a map in the requested crs, on the requested bbox desigend to be shown in a device of a width and a height. Some formats require to apply a style in the server side (e.g. png, jpeg, gif) and some others might include a reference to a style to be applied in the client side. The feature properties to include in the tile representation can be limited using a query parameter.
      operationId: getMapCollections
      parameters:
        # Needs to add the collectionIds and bbox etc as query
        - $ref: '#/components/parameters/f-json'
        - $ref: '#/components/parameters/map-crs'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/bbox'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collections'
        - $ref: '#/components/parameters/styles'
        - $ref: '#/components/parameters/width'
        - $ref: '#/components/parameters/height'
        - $ref: '#/components/parameters/transparent'
        - $ref: '#/components/parameters/bgcolor'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/datetime'
        - $ref: '#/components/parameters/elevation'
      responses:
        '200':
          description: |- 
            Retrieves a map that renders objects of one or more collections in the requested crs, on the requested bbox desigend to be shown in a rendering device of a width and a height.
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
            image/png:
              schema:
                type: string
                format: binary
            image/gif:
              schema:
                type: string
                format: binary
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureCollectionGeoJSON'
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/collections/{collectionId}/map/{styleId}':
    get:
      tags:
        - Maps
      summary: fetch a map from a collection
      description: |-
        Retrieves a map in the requested crs, on the requested bbox desigend to be shown in a rendering device of a width and a height. Some formats require to apply a style in the server side (e.g. png, jpeg, gif) and some others might include a reference to a style to be applied in the client side. The feature properties to include in the tile representation can be limited using a query parameter.        
      operationId: getMapCollectionId
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collectionId'
        - $ref: '#/components/parameters/styleId'
        - $ref: '#/components/parameters/f-json'
        - $ref: '#/components/parameters/map-crs'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/bbox'
        - $ref: '#/components/parameters/width'
        - $ref: '#/components/parameters/height'
        - $ref: '#/components/parameters/transparent'
        - $ref: '#/components/parameters/bgcolor'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/datetime'      
        - $ref: '#/components/parameters/elevation'
      responses:
        '200':
          description: |- 
            Retrieves a map that renders objects of the collectionId in the requested crs, on the requested bbox desigend to be shown in a rendering device of a width and a height.
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
            image/png:
              schema:
                type: string
                format: binary
            image/gif:
              schema:
                type: string
                format: binary
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureCollectionGeoJSON'
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
  '/map/info':
    get:
      tags:
        - Maps
        - FeatureInfos
      summary: fetch information about a point in a map from one or more collections
      description: |-
        Retrieves a getFeatureInfo in map in the requested crs, on the requested bbox desigend to be shown in a rendering device of a width and a height. Some formats require to apply a style in the server side (e.g. png, jpeg, gif) and some others might include a reference to a style to be applied in the client side. The feature properties to include in the tile representation can be limited using a query parameter.        
      operationId: getFeatureInfoCollections
      parameters:
        - $ref: '#/components/parameters/f-json-html'
        - $ref: '#/components/parameters/map-crs'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/bbox'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collections'
        - $ref: '#/components/parameters/styles'
        - $ref: '#/components/parameters/width'
        - $ref: '#/components/parameters/height'
        - $ref: '#/components/parameters/transparent'
        - $ref: '#/components/parameters/bgcolor'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/datetime'      
        - $ref: '#/components/parameters/elevation'
        - $ref: '#/components/parameters/coord_i'
        - $ref: '#/components/parameters/coord_j'
        - $ref: '#/components/parameters/infoTemplate'
        - $ref: '#/components/parameters/mapFormat'
      responses:
        '200':
          description: |- 
            Retrieves a map that renders objects of the collectionId in the requested crs, on the requested bbox desigend to be shown in a rendering device of a width and a height.
          content:
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureCollectionGeoJSON'
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'          
  '/collections/{collectionId}/map/{styleId}/info':
    get:
      tags:
        - Maps
        - FeatureInfos
      summary: fetch information about a point on a map from a collection
      description: |-
        Retrieves a getFeatureInfo in map in the requested crs, on the requested bbox desigend to be shown in a rendering device of a width and a height. Some formats require to apply a style in the server side (e.g. png, jpeg, gif) and some others might include a reference to a style to be applied in the client side. The feature properties to include in the tile representation can be limited using a query parameter.        
      operationId: getFeatureInfoCollectionId
      parameters:
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/collectionId'
        - $ref: '#/components/parameters/styleId'
        - $ref: '#/components/parameters/f-json-html'
        - $ref: '#/components/parameters/map-crs'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/bbox'
        - $ref: '#/components/parameters/width'
        - $ref: '#/components/parameters/height'
        - $ref: '#/components/parameters/transparent'
        - $ref: '#/components/parameters/bgcolor'
        - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/parameters/datetime'      
        - $ref: '#/components/parameters/elevation'
        - $ref: '#/components/parameters/coord_i'
        - $ref: '#/components/parameters/coord_j'
        - $ref: '#/components/parameters/infoTemplate'
        - $ref: '#/components/parameters/mapFormat'
      responses:
        '200':
          description: |- 
            Retrieves a map that renders objects of the collectionId in the requested crs, on the requested bbox desigend to be shown in a rendering device of a width and a height.
          content:
            application/geo+json:
              schema:
                $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/featureCollectionGeoJSON'
        '404':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/NotFound'
        '500':
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/responses/ServerError'
components:
  schemas:
    collectionInfo:
      allOf:
      - $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/collectionInfo'
      - type: object
        properties:
          styles:
            $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/style-set'
          mapCRSSetLink: 
            $ref: '#/components/schemas/mapCRSSetLink'
          tileMatrixSetLink:
            $ref: '#/components/schemas/tileMatrixSetLink-set'
          defaultStyle:
            type: string
            description: |-
              the style id of a recommended default style to use for this collection
            example: 'topographic'
    collectionInfo-patch:
      type: object
      properties:
        styles:
          $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/style-set'
        defaultStyle:
          type: string
          nullable: true
          description: |-
            the style id of a recommended default style to use for this collection
          example: 'topographic'
    tileMatrixSetLink-set:
      description: |-
        This list tileMatrixSetLink as defined in OGC 17-083r2 supported by this collectionId. 
        The presence of this property indicates that the collection is available as tiles
      type: array
      nullable: true
      items:
        $ref: '#/components/schemas/tileMatrixSetLink-entry'
      example:
        - id: 'WebMercatorQuad'
          links:
          - href: 'https://example.com/api/1.0/tileMatrixSet/WebMercatorQuad?f=ogc-tms-1-0'
            type: 'application/vnd.ogc-tms-1-0.tms+json'
            rel: 'tileMatrixSet'
    tileMatrixSetLink-entry:
      type: object
      nullable: true
      required:
        - id
        - links
      properties:
        id:
          type: string
          nullable: true
        links:
          type: array
          nullable: true
          minItems: 1
          items:
            $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/link'
        tileMatrixSetLimits:
          type: array
          nullable: true
          minItems: 1
          items:
            $ref: '#/components/schemas/tileMatrixSetLimits-entry'
    tileMatrixSetLimits-entry:
      type: object
      nullable: true
      required:
        - tileMatrix
        - minTileRow
        - maxTileRow
        - minTileCol
        - maxTileCol
      properties:
        tileMatrix:
          type: string
        minTileRow:
          type: number
          nullable: true
          minItems: 0
          items:
            $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/link'
        tileMatrixSetLimits:
          type: array
          nullable: true
          minItems: 1
          items:
            $ref: '#/components/schemas/tileMatrixSetLimits-entry'
    mapCRSSetLink:
      description: |-
        This list crsIds supported by this collectionId.  The presence of this property indicates that the collection is available as maps
      type: array
      nullable: true
      items:
        $ref: '#/components/schemas/crs-entry'
      example:
        - id: 'CRS:84'
          links:
          - href: 'http://www.opengis.net/def/crs/OGC/1.3/CRS84'
            type: 'application/xml'
            rel: 'describedby'
    crs-entry:
      type: object
      nullable: true
      required:
        - id
        - links
      properties:
        id:
          type: string
          nullable: false
        title:
          type: string
          nullable: true
        links:
          type: array
          nullable: false
          minItems: 1
          items:
            $ref: 'https://api.swaggerhub.com/domains/joanma747/ogc-api/1.0.0#/components/schemas/link'
    tiles-set:
      description: |-
        This is the response of a multiple tiles request.
      required:
        - type
      type: array
      items:
        $ref: '#/components/schemas/tiles-entry'
    tiles-entry:
      description: |-
        This is an entry on a multiple tiles request.
      type: object
      required:
        - tileURL
        - tileMatrix
        - tileRow
        - tileCol
      properties: 
        tileURL:
          type: string
          format: anyURI
          nullable: false
        tileMatrix:
          type: string
          nullable: false
        tileRow:
          type: number
          nullable: false
        tileCol:
          type: number
          nullable: false
        width:
          type: number
          description: |-
            The width of the tile in randering device pixels. If it excedes the visual display area be should cut when displayed
          nullable: true
        height:
          type: number
          description: |-
            The height of the tile in randering device pixels. If it excedes the visual display area be should cut when displayed
          nullable: true
        top:
          type: number
          description: |-
            Vertical position from the top of the visual display area in pixels. Negative value means that the left side of the tile is outside the top-left corner of the display and should be cut when displayed
          nullable: true
        left:
          type: number
          description: |-
            Horizontal position from the left of the visual display area in pixels. Negative value means that the left side of the tile is outside the top-left corner of the display and should be cut when displayed
          nullable: true
  parameters:
    f-json-html:
      name: f
      in: query
      description: |-
        The format of the response. If no value is provided, the standard http
        rules apply, i.e., the accept header is used to determine the format.

        Pre-defined values are "json" and "html". The response to other 
        values is determined by the server.
      required: false
      style: form
      explode: false
      schema:
        type: string
        enum:
          - json
          - html
      example: json    
    f-json:
      name: f
      in: query
      description: |-
        The format of the response. If no value is provided, the standard http
        rules apply, i.e., the accept header is used to determine the format.
        
        The only pre-defined value is "json". The response to other values is 
        determined by the server.
      required: false
      style: form
      explode: false
      schema:
        type: string
        enum:
          - json
      example: json
    f-json-zip:
      name: f
      in: query
      description: |-
        The format of the response. If no value is provided, the standard http
        rules apply, i.e., the accept header is used to determine the format.
        
        The only pre-defined value is "json". The response to other values is 
        determined by the server.
      required: false
      style: form
      explode: false
      schema:
        type: string
        enum:
          - json
          - zip
      example: json      
    f-png-jpeg-vector:
      name: f
      in: query
      description: |-
        The format of the response. If no value is provided, the standard http rules apply, i.e., the accept header is used to determine the format.
        
        Pre-defined values are "mvt" for a Mapbox Vector Tile, "json" for a GeoJSON tiled feature collection and jpeg, png or gif for image based tiles 
        The response to other values is determined by the server.
      required: false
      style: form
      explode: false
      schema:
        type: string
        enum:
          - pgn
          - jpeg
          - gif
          - mvt
          - json
      example: png
    styleId:
      name: styleId
      in: path
      description: |-
        The styleId that should be included in the map or tile. Each collectionId has a valid list of stylesId. To know the valid styleId values of each collectionId use /collections/{collectionId}.
      required: true
      schema:
        type: string
    styles:
      name: styles
      in: query
      description: |-
        The styleId that should be included in the map or tile. Each collectionId has a valid list of stylesId. To know the valid styleId values of each collectionId use /collections/{collectionId}.
        The parameter value is a list of comma separated styles identifiers. If the parameter 'collections' exists, the list should be as long as 'collections' and each styleId correspons to one collectionId. If the path includes 'collections/{collectionId}' one style should be mentioned. 
      required: false
      style: form
      explode: false
      schema:
        type: string
    width:
      name: width
      in: query
      description: |-
        Width in pixels of map picture.
      required: true
      style: form
      explode: false
      schema:
        type: number
    height:
      name: height
      in: query
      description: |-
        Height in pixels of map picture.
      required: true
      style: form
      explode: false
      schema:
        type: number    
    coord_i:
      name: i
      in: query
      description: |-
        Height in pixels of map picture.
      required: true
      style: form
      explode: false
      schema:
        type: number
    coord_j:
      name: j
      in: query
      description: |-
        Height in pixels of map picture.
      required: true
      style: form
      explode: false
      schema:
        type: number        
    scaleDenRange:
      name: scaleDenRange
      in: query
      description: |-
        A ange of scale denominators (that canb e used to deduce a list of tileMatrix names). Please consider that scale denominators have several significant digits. To prevent mistakes apply tolerances to intervals. Even if you want to specify a single scale denominator use an interval with tolerance
      required: false
      style: form
      explode: false
      schema:
        type: array
        minItems: 2
        maxItems: 2
        items:
          type: number
    infoTemplate:
      name: infoTemplate
      in: query
      description: |-
        template used for showing the info. This parameter can be used to select among GML application schemas or JSON shemas and provide alternative presentations for the same info
      required: false
      style: form
      explode: false
      schema:
        type: number        
    transparent:
      name: transparent
      in: query
      description: |-
        Background transparency of map (default=FALSE). 
      required: false
      style: form
      explode: false
      schema:
        type: boolean    
    bgcolor:
      name: bgcolor
      in: query
      description: |-
        Hexadecimal red-green-blue[-alpha] color value for the background color (default=0xFFFFFF) if alpha is not specified "opaque" opacity is assumed.
      required: false
      style: form
      explode: false
      schema:
        type: string    
    elevation:
      name: elevation
      in: query
      description: |-
        Elevation value
      required: false
      style: form
      explode: false
      schema:
        type: number        
    map-crs:
      name: crs
      in: query
      description: |-
        CRSId used to rended the map. It is also the CRS of the bbox parameter.
        You can only ask for CRSs that are valid of the collectionId.
      required: false
      style: form
      explode: false
      schema:
        type: string
      example: 'EPSG:4326'
    mapFormat:
      name: mapFormat
      in: query
      description: |-
        Internal format of the maps referenced by a getFeatureInfo.
      required: false
      style: form
      schema:
        type: string          
    tileFormat:
      name: tileFormat
      in: query
      description: |-
        Internal format of the multi- tiles referenced or embedded of for the info request on a tile
      required: false
      style: form
      schema:
        type: string          
    embedded:
      name: embedded
      in: query
      description: |-
        Are the tiles embedded. If false they are only referenced.
      required: false
      style: form
      schema:
        type: boolean
  responses: {}
